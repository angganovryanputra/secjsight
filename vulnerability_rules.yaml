rules:
  # 1. Penggunaan eval()
  - type: "eval"
    pattern: "eval("
    description: "Penggunaan eval() dapat menyebabkan serangan XSS (Cross-site Scripting) dan eksekusi kode."
    reference: "https://cwe.mitre.org/data/definitions/95.html"

  # 2. Penggunaan document.write()
  - type: "document_write"
    pattern: "document.write("
    description: "Penggunaan document.write() tidak aman jika memasukkan data dinamis dan dapat membuka peluang XSS."
    reference: "https://cwe.mitre.org/data/definitions/79.html"

  # 3. Penggunaan innerHTML
  - type: "innerHTML"
    pattern: ".innerHTML"
    description: "Penggunaan innerHTML dengan data tidak tervalidasi dapat menyebabkan serangan XSS."
    reference: "https://cwe.mitre.org/data/definitions/79.html"

  # 4. Penggunaan setTimeout() dengan kode string
  - type: "setTimeout_eval"
    pattern: "setTimeout("
    description: "Menggunakan setTimeout dengan string sebagai argumen pertama rentan terhadap eksekusi kode."
    reference: "https://cwe.mitre.org/data/definitions/95.html"

  # 5. Penggunaan setInterval() dengan kode string
  - type: "setInterval_eval"
    pattern: "setInterval("
    description: "Menggunakan setInterval dengan string sebagai argumen pertama rentan terhadap eksekusi kode."
    reference: "https://cwe.mitre.org/data/definitions/95.html"

  # 6. Fungsi Function() untuk membuat fungsi dari string
  - type: "function_constructor"
    pattern: "new Function("
    description: "Penggunaan Function constructor dengan string rentan terhadap injeksi kode."
    reference: "https://cwe.mitre.org/data/definitions/95.html"

  # 7. XMLHttpRequest tanpa validasi sumber
  - type: "xmlhttprequest"
    pattern: "new XMLHttpRequest()"
    description: "Menggunakan XMLHttpRequest tanpa validasi sumber atau CORS dapat mengakibatkan kebocoran data."
    reference: "https://cwe.mitre.org/data/definitions/200.html"

  # 8. Menggunakan location.href untuk redirect
  - type: "location_href"
    pattern: "location.href"
    description: "Penggunaan location.href tanpa validasi dapat dieksploitasi untuk open redirect."
    reference: "https://cwe.mitre.org/data/definitions/601.html"

  # 9. window.open dengan sumber tak dikenal
  - type: "window_open"
    pattern: "window.open("
    description: "Penggunaan window.open tanpa validasi dapat memungkinkan tabnabbing dan phishing."
    reference: "https://cwe.mitre.org/data/definitions/200.html"

  # 10. localStorage manipulasi data
  - type: "localstorage_access"
    pattern: "localStorage"
    description: "Penggunaan localStorage tanpa enkripsi atau validasi dapat mengakibatkan kebocoran data."
    reference: "https://cwe.mitre.org/data/definitions/922.html"

  # 11. sessionStorage manipulasi data
  - type: "sessionstorage_access"
    pattern: "sessionStorage"
    description: "Penggunaan sessionStorage tanpa validasi dapat menyebabkan penyimpanan data sensitif yang rentan."
    reference: "https://cwe.mitre.org/data/definitions/922.html"

  # 12. Cookie tidak aman
  - type: "document_cookie"
    pattern: "document.cookie"
    description: "Mengakses document.cookie dapat membuka peluang serangan XSS dan kebocoran data."
    reference: "https://cwe.mitre.org/data/definitions/79.html"

  # 13. Pemanggilan JSON.parse tanpa sanitasi
  - type: "json_parse"
    pattern: "JSON.parse("
    description: "Penggunaan JSON.parse tanpa sanitasi data dapat memungkinkan injeksi kode."
    reference: "https://cwe.mitre.org/data/definitions/74.html"

  # 14. openDatabase untuk WebSQL
  - type: "open_database"
    pattern: "openDatabase("
    description: "Penggunaan openDatabase pada WebSQL rentan terhadap SQL injection jika input tidak aman."
    reference: "https://cwe.mitre.org/data/definitions/89.html"

  # 15. Penggunaan WebSocket tanpa autentikasi
  - type: "websocket"
    pattern: "new WebSocket("
    description: "WebSocket tanpa autentikasi rentan terhadap serangan Man-in-the-Middle dan kebocoran data."
    reference: "https://cwe.mitre.org/data/definitions/319.html"

  # 16. Penggunaan postMessage tanpa validasi sumber
  - type: "postmessage"
    pattern: "postMessage("
    description: "Penggunaan postMessage tanpa validasi asal sumber dapat menyebabkan data leak atau manipulasi konten."
    reference: "https://cwe.mitre.org/data/definitions/927.html"

  # 17. Penggunaan atob() untuk decode base64 yang berisiko
  - type: "atob_base64"
    pattern: "atob("
    description: "Penggunaan atob untuk decode data Base64 rentan terhadap injeksi jika input tidak tervalidasi."
    reference: "https://cwe.mitre.org/data/definitions/74.html"

  # 18. Penggunaan btoa() untuk encode base64 yang berisiko
  - type: "btoa_base64"
    pattern: "btoa("
    description: "Penggunaan btoa untuk encode data Base64 rentan jika input tidak tervalidasi."
    reference: "https://cwe.mitre.org/data/definitions/74.html"

  # 19. fetch API tanpa validasi sumber atau CORS
  - type: "fetch"
    pattern: "fetch("
    description: "Penggunaan fetch tanpa validasi sumber atau kontrol CORS dapat mengakibatkan kebocoran data."
    reference: "https://cwe.mitre.org/data/definitions/200.html"
    
  # 20. Penggunaan Array.prototype.join untuk debug log sensitive
  - type: "array_join"
    pattern: ".join("
    description: "Penggunaan .join dengan data sensitif dapat menghasilkan output debug log yang rentan bocor."
    reference: "https://cwe.mitre.org/data/definitions/117.html"

  # 21. Deteksi parameter sebagai entry point potensial
  - type: "parameter_entry_point"
    pattern: "?"
    description: "Parameter dalam URL dapat menjadi entry point yang perlu divalidasi secara manual."
    reference: "https://cwe.mitre.org/data/definitions/20.html"  # CWE-20: Improper Input Validation

